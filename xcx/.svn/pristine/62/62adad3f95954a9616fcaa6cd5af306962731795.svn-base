// landing.js
Page({

  /**
   * 页面的初始数据
   */
  data: {
      test:'获取验证码',
      lck:true,
      phone:0
  },

  /**
   * 生命周期函数--监听页面加载
   */
  check:function(e){
    var phone = e.detail.value
    if(phone==''){
      this.data.phone=0
    }
    else if (/^1[\d]{10}$/.test(phone)){
      this.data.phone = 2
    }else{
      this.data.phone = 1
    }
  },
  play_test:function(){
    var phone= this.data.phone
    console.log(phone)
    if(phone==0){
      this.landing('请输入手机号')
    }else if(phone==1){
      this.landing('手机号码不正确')
    }else{
      // https://alipay.zx-tour.com/Account/verify
      var that=this
        if (this.data.lck) {
          wx.request({
            url: 'https://alipay.zx-tour.com/Account/verify',
            dataType:'json',
            method:'post',
            data:phone,
            success:function(res){
                that.setData({ lck: false })
                var num = 60
                that.setData({ lck: false })
                that.setData({ test: '已发送(60秒)' })
                var time = setInterval(function () {
                  num--
                  that.setData({ test: '已发送(' + num + '秒)' })
                  if (num <= 0) {
                    this.setData({ lck: true })
                    clearInterval(time)
                  }
                }, 1000)
            }
          })
        } else {
          return false
        }
    }
  },
  landing:function(content){
      wx.showModal({
        title: '提示',
        content: content,
        showCancel:false
      })
  },
  onLoad: function (options) {
  
  },

  /**
   * 生命周期函数--监听页面初次渲染完成
   */
  onReady: function () {
  
  },

  /**
   * 生命周期函数--监听页面显示
   */
  onShow: function () {
  
  },

  /**
   * 生命周期函数--监听页面隐藏
   */
  onHide: function () {
  
  },

  /**
   * 生命周期函数--监听页面卸载
   */
  onUnload: function () {
  
  },

  /**
   * 页面相关事件处理函数--监听用户下拉动作
   */
  onPullDownRefresh: function () {
  
  },

  /**
   * 页面上拉触底事件的处理函数
   */
  onReachBottom: function () {
  
  },

  /**
   * 用户点击右上角分享
   */
  onShareAppMessage: function () {
  
  },

  /**
   * 页面上拉触底事件的处理函数
   */
  onReachBottom: function () {
  
  },

  /**
   * 页面相关事件处理函数--监听用户下拉动作
   */
  onPullDownRefresh: function () {
  
  }
})